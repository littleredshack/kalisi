<div class="properties-rhs-panel"
     [class.visible]="isVisible"
     [class.dragging]="dragging"
     [class.resizing]="resizing"
     [style.left.px]="panelX"
     [style.top.px]="panelY"
     [style.width.px]="panelWidth"
     [style.height.px]="panelHeight">

  <!-- Resize Handles -->
  <div class="resize-handle resize-right" (mousedown)="onResizeStart($event, 'right')"></div>
  <div class="resize-handle resize-bottom" (mousedown)="onResizeStart($event, 'bottom')"></div>
  <div class="resize-handle resize-bottom-right" (mousedown)="onResizeStart($event, 'bottom-right')"></div>

  <!-- Panel Header - Draggable -->
  <div class="properties-header" (mousedown)="onHeaderDragStart($event)">
    <div class="header-title">
      <i class="pi pi-check-square header-icon"></i>
      <h3 class="title-text">Properties</h3>
    </div>
    <div class="header-controls">
      <button
        class="control-btn close-btn"
        (click)="closePanel()"
        pTooltip="Close properties"
        tooltipPosition="left">
        <i class="pi pi-times"></i>
      </button>
    </div>
  </div>

  <!-- Properties Content -->
  <div class="properties-content">
    <ng-container *ngIf="panelState$ | async as vm">
      <app-properties-panel
        [selectedLibraryItem]="selectedLibraryItem"
        [selectedViewNodeDetails]="selectedViewNodeDetails"
        [nodeSelection]="vm.selection"
        [hasActiveCanvas]="vm.hasCanvas"
        [cameraInfo]="vm.camera"
        [autoLayoutLabel]="vm.autoState"
        [isAutoLayoutEnabled]="vm.autoState === 'Auto Layout: ON'"
        [canUndo]="vm.canUndo"
        [canRedo]="vm.canRedo"
        [collapseLevelOptions]="vm.levels"
        [layoutOptions]="vm.layout.options.length ? vm.layout : null"
        [lensOptions]="vm.lens.options.length ? vm.lens : null"
        [presetOptions]="vm.preset.options"
        [activePresetId]="vm.preset.activeId"
        [activePresetLabel]="vm.preset.activeLabel"
        [presetDescription]="vm.preset.description"
        [presetPalette]="vm.preset.palette"
        [hasPresetOverrides]="vm.preset.hasOverrides">
      </app-properties-panel>
    </ng-container>
  </div>
</div>
